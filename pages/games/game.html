<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Game Details - Gameboxd</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    .game-details {
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
    }
    .game-header {
      display: flex;
      margin-bottom: 30px;
    }
    .game-cover {
      width: 300px;
      min-width: 300px;
      margin-right: 30px;
    }
    .game-cover img {
      width: 100%;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .game-info {
      flex: 1;
    }
    .game-title {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }
    .game-meta {
      color: #666;
      margin-bottom: 20px;
    }
    .rating-section {
      margin-top: 20px;
      padding: 20px;
      background-color: #f5f5f5;
      border-radius: 8px;
    }
    .game-description {
      line-height: 1.6;
      margin-bottom: 30px;
    }
    .loading, .error {
      padding: 40px;
      text-align: center;
      font-size: 1.2rem;
    }
    .back-link {
      display: inline-block;
      margin-bottom: 20px;
      color: #0066cc;
      text-decoration: none;
    }
    .back-link:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <div class="logo">Gameboxd</div>
      <div class="nav-links">
        <a href="/">Home</a>
        <a href="/games">Games</a>
        <a href="/login.html">Login</a>
        <a href="/register.html">Register</a>
      </div>
    </nav>
  </header>

  <main>
    <div id="game-container" class="game-details">
      <div class="loading">Loading game details...</div>
    </div>
  </main>

  <footer>
    <p>&copy; 2023 Gameboxd. All rights reserved.</p>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        // Get game ID from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const gameId = urlParams.get('id');
        
        if (!gameId) {
          throw new Error('No game ID provided');
        }
        
        // Fetch game details from API
        const response = await fetch(`https://api.gameboxd.me/api/games/${gameId}`);
        if (!response.ok) {
          throw new Error('Failed to fetch game details');
        }
        
        const game = await response.json();
        
        // Update page title
        document.title = `${game.title} - Gameboxd`;
        
        // Display game details
        const gameContainer = document.getElementById('game-container');
        gameContainer.innerHTML = `
          <a href="/" class="back-link">← Back to Home</a>
          <div class="game-header">
            <div class="game-cover">
              <img src="${game.cover_image_url || 'images/placeholder.jpg'}" alt="${game.title}">
            </div>
            <div class="game-info">
              <h1 class="game-title">${game.title}</h1>
              <div class="game-meta">
                <p>Released: ${formatDate(game.release_date)}</p>
                <p>Developer: ${game.developer || 'Unknown'}</p>
                <p>Publisher: ${game.publisher || 'Unknown'}</p>
              </div>
              <div class="game-description">
                ${game.description || 'No description available.'}
              </div>
              <div class="rating-section">
                <h3>Rate this game</h3>
                <div class="rating-controls">
                  <select id="rating-select">
                    <option value="">Select rating</option>
                    <option value="1">1 - Poor</option>
                    <option value="2">2 - Below Average</option>
                    <option value="3">3 - Average</option>
                    <option value="4">4 - Good</option>
                    <option value="5">5 - Excellent</option>
                  </select>
                  <button id="submit-rating">Submit Rating</button>
                </div>
                <div id="rating-message"></div>
              </div>
            </div>
          </div>
        `;
        
        // Add event listener for rating submission
        document.getElementById('submit-rating')?.addEventListener('click', async () => {
          const ratingSelect = document.getElementById('rating-select');
          const rating = ratingSelect.value;
          
          if (!rating) {
            document.getElementById('rating-message').textContent = 'Please select a rating';
            return;
          }
          
          // Here you would typically send the rating to your backend
          document.getElementById('rating-message').textContent = 'Rating submitted successfully!';
        });
        
      } catch (error) {
        console.error('Error loading game details:', error);
        document.getElementById('game-container').innerHTML = `
          <a href="/" class="back-link">← Back to Home</a>
          <div class="error">Error loading game details. Please try again later.</div>
        `;
      }
    });
    
    // Helper function to format dates
    function formatDate(dateString) {
      if (!dateString) return 'Unknown';
      const date = new Date(dateString);
      return date.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      });
    }
  </script>
</body>
</html> 